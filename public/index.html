<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Unis</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
  body {
    background-color: #362c2c; /* Dark Gray */
    color: white;
    font-family: 'Poppins', Arial, sans-serif;
    transition: background-color 2s ease-in-out, color 0.5s ease; /* Smooth transition for background and text color */
  }
  
  body:hover {
    color: #17252a;
    background-color: #3aafa9; /* Teal background on hover */
  }
  
  /* Navbar brand hover transition */
  .navbar-brand {
    transition: color 0.3s ease, transform 0.3s ease-in-out;
    margin: 1%;
    font-size: 1.8em;
    font-weight: bold;
    letter-spacing: 1px;
  }
  
  .navbar-brand:hover {
    color: #ff6347; /* Tomato color on hover */
    transform: scale(1.1) rotate(-2deg); /* Zoom and rotate effect */
  }
  
  /* Navbar links transition */
  .nav-link {
    transition: color 0.3s ease-in-out, background-color 0.3s ease-in-out;
    padding: 8px 15px;
    border-radius: 20px;
  }
  
  .nav-link:hover {
    color: #ff7f50; /* Coral */
    font-weight: bold;
    background-color: rgba(255, 255, 255, 0.1); /* Transparent background on hover */
  }
  
  /* Search button transition */
  #search-button {
    transition: background-color 0.3s ease-in-out, border-color 0.3s ease-in-out;
    background-color: #6c757d; /* Default gray */
    color: white;
    border-radius: 25px;
  }
  
  #search-button:hover {
    background-color: #28a745; /* Green on hover */
    border-color: #28a745;
    transform: scale(1.05); /* Slight zoom effect */
  }
  
  /* Navbar toggler icon transition */
  .navbar-toggler {
    transition: transform 0.3s ease-in-out;
  }
  
  .navbar-toggler:hover {
    transform: rotate(90deg); /* Rotate on hover */
  }
  
  /* Smooth collapse transition */
  .collapse {
    transition: height 0.5s ease;
  }
  
  /* Social media icons */
  .whatsapp-icon, .fa-facebook-f, .fa-instagram {
    font-size: 2.5em;
    margin: 0 10px;
    transition: color 0.3s ease, transform 0.3s ease;
    border-radius: 50%;
    padding: 10px;
  }
  
  .whatsapp-icon:hover {
    color: #25d366; /* WhatsApp green */
    background-color: rgba(37, 211, 102, 0.2); /* Subtle background on hover */
    transform: scale(1.2);
  }
  
  .fa-facebook-f:hover {
    color: #1c91ff; /* Facebook blue */
    background-color: rgba(28, 145, 255, 0.2); /* Subtle background on hover */
    transform: scale(1.2);
  }
  
  .fa-instagram:hover {
    color: #e4405f; /* Instagram pink-red */
    background-color: rgba(228, 64, 95, 0.2); /* Subtle background on hover */
    transform: scale(1.2);
  }
  
  /* Fancy remove button */
  .remove {
    background-color: #dc3545; /* Bootstrap red */
    color: white;
    border: none;
    padding: 10px 20px;
    cursor: pointer;
    font-size: 1rem;
    border-radius: 50px;
    margin-left: 80%;
    transition: background-color 0.3s ease-in-out, transform 0.3s ease;
  }
  
  .remove:hover {
    background-color: #c82333; /* Darker red */
    transform: scale(1.1); /* Slight zoom on hover */
  }
  
  /* Gradient animation for post backgrounds */
  @keyframes gradientAnimation {
    0% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
    100% {
      background-position: 0% 50%;
    }
  }
  
  /* Content area styling */
  #embeddedContent {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
  }
  
  .post {
    background: linear-gradient(270deg, rgba(34, 34, 34, 1), rgb(57, 14, 114)); /* Dark gradient */
    background-size: 400% 400%;
    animation: gradientAnimation 5s ease infinite; /* Animation for the gradient */
    background-origin: padding-box;
    border: 4px black solid;
    display: block;
    width: 98%;
    margin: 1px;
    padding: 8px;
    border-radius: 5%;
    color: white;
    transition: transform 0.3s ease;
  }
  
  #note {
    color: #dc3545;
    font-weight: bolder;
  }
  
  #not {
    color: #dc3545;
    text-decoration: line-through;
    flex: 1;
    font-weight: bolder;
  }
  
  .post:hover {
    background: radial-gradient(270deg, rgb(138, 135, 135), rgb(248, 245, 255));
    transform: scale(1.02); /* Slightly scale the post on hover */
  }
  
  /* Flex container for submission form and embedded content */
  .flex-container {
    display: flex;
    flex-direction: row;
    height: 100vh; /* Take full height of the viewport */
  }
  
  /* Submission form styling */
  #submission-form {
    width: 30%; /* Occupy 30% of the screen on desktop view */
    background-color: #8dc6ff; /* Light background color */
    padding: 20px;
    border-right: 1px solid #ccc; /* Divider between sections */
  }
  
  /* Embedded content styling */
  #embeddedContent {
    flex: 1; /* Take the remaining space on the screen */
    overflow-y: auto; /* Enable scrolling */
    padding: 20px;
  }
  
  /* Media queries for small devices */
  @media (max-width: 768px) {
    #submission-form {
      width: 100%; /* Full width for smaller devices */
      padding: 10px;
      border-right: none;
    }
  
    .flex-container {
      flex-direction: column; /* Stack submission form and embedded content vertically */
      height: auto; /* Let the height adjust naturally */
    }
  
    .post {
      width: 100%;
      margin: 10px 0;
      padding: 10px;
    }
  
    .remove {
      margin-left: 0;
      width: 100%; /* Full width button for easier interaction on mobile */
      font-size: 0.9rem;
    }
  }

</style>

</head>

<body>

  <!------------------------------Header--------------------------------->
  <nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
      <!-- Navbar header with branding -->
      <a class="navbar-brand" href="#">UNIS</a>
  
      <!-- Toggler for mobile view -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
  
      <!-- Navbar links and icons -->
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://puit.vercel.app/">PU IT</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://skillspectrumpk.vercel.app/">SKILL SPECTRUM</a>
          </li>
        </ul>
  
        <!-- Search form and social icons -->
        <div class="d-flex align-items-center">
          <form class="d-flex me-3" role="search" onsubmit="return false;">
            <input class="form-control me-2" type="search" id="search-bar" placeholder="Search" aria-label="Search" onkeypress="checkEnter(event)">
            <button class="btn btn-outline-success" type="button" id="search-button" onclick="searchPosts();">Search</button>
          </form>
          <!-- Social media icons container with flex layout -->
          <ul class="navbar-nav d-flex flex-row">
            <li class="nav-item me-3">
              <a class="our-links nav-link whatsapp-icon" href="https://chat.whatsapp.com/GGByduLdV3uEhvzAdUFG9Q" target="_blank" title="Chat on WhatsApp">
                <i class="fab fa-whatsapp"></i>
              </a>
            </li>
            <li class="nav-item me-3">
              <a class="our-links nav-link" href="https://www.facebook.com/share/g/XELu7wpG2gB2Muh1/" target="_blank" title="Visit Facebook">
                <i class="fab fa-facebook-f"></i>
              </a>
            </li>
            <li class="nav-item">
              <a class="our-links nav-link" href="https://ig.me/j/AbaAE8jX2hFVC6lM/" target="_blank" title="Visit Instagram">
                <i class="fab fa-instagram"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </nav>
  
  
  

  <div class="flex-container">
    <div id="submission-form">
      <div class="container mt-4">
        <h2>Upload Your Content Here</h2>
        <form id="linkForm">
          <label for="linkName">Name of Link:</label>
          <input type="text" id="linkName" name="linkName" class="form-control" required><br>

          <label for="linkUrl">Link to be embedded:</label>
          <input type="url" id="linkUrl" name="linkUrl" class="form-control" required><br>
          <p><strong id="note">NOTE:</strong> provide comprehensive details about your content. Paste only HTTP links. If the link is from Google Drive, please ensure it is a shareable link and ending with <strong>preview</strong> not with<div id="not">view?usp=drive_link</div></p>
          <button type="submit" class="btn btn-primary">Submit Link</button>
        </form>
      </div>
    </div>
    <!-- <button onclick="clearAllLinks()">Clear All Links</button> -->

    <div id="embeddedContent"></div>
  </div>
<script nonce="random_nonce_value">
// Variable to store all links
let allLinks = [];

// Handle link form submission
document.addEventListener('DOMContentLoaded', () => {
  // Load links from the server when the page loads
  loadLinks();

  // Handle form submission
  document.getElementById('linkForm').addEventListener('submit', async (event) => {
    event.preventDefault();

    const linkName = document.getElementById('linkName').value;
    const linkUrl = document.getElementById('linkUrl').value;

    await saveLink(linkName, linkUrl); // Save the link
    await loadLinks(); // Reload links after saving
  });
});

// Function to save the link to the server
const saveLink = async (linkName, linkUrl) => {
  try {
      const response = await fetch('https://unis-green.vercel.app/saveLink', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ linkName, linkUrl }),
    });

    if (!response.ok) {
      throw new Error('Network response was not ok ' + response.statusText);
    }

    const data = await response.json();
    console.log('Link saved successfully:', data);
  } catch (error) {
    console.error('Failed to save link:', error);
  }
};

// Function to load and display embedded links
async function loadLinks() {
  console.log('loadLinks called');

  const response = await fetch('https://unis-green.vercel.app/links'); // Fetch links from the server
  const data = await response.json();

  console.log('Links response:', data);

  if (data.success) {
    const links = data.data;

    if (!Array.isArray(links)) {
      console.error('Error: links is not an array');
      return;
    }

    console.log('Loaded links:', links);

    // Clear the container before loading new links
    const embeddedContent = document.getElementById('embeddedContent');
    embeddedContent.innerHTML = ''; 

    // Populate allLinks with the fetched links
    allLinks = []; // Reset allLinks to avoid duplicates
    links.forEach(link => {
      allLinks.push(link);
    });

    console.log('Updated allLinks:', allLinks);

    // Populate the embedded content
    allLinks.forEach(link => {
      const linkElement = `
        <div class="post">
          <button class="post">
            <h2 class="file-name" onclick="toggleContent(this)">${link.name}</h2>
          </button>
          <div class="content" style="display: none;">
            <iframe src="${link.url}" width="100%" height="569" allow="autoplay" frameborder="0" allowfullscreen></iframe>
          </div>
        </div>
      `;
      embeddedContent.innerHTML += linkElement; // Append new links
    });
  } else {
    console.error(data.message);
  }
}

// Function to open the link in the iframe
function toggleContent(element) {
  let contentDiv = element.parentNode.nextElementSibling; // Get the next sibling (the content div)
  contentDiv.style.display = (contentDiv.style.display === "none" || contentDiv.style.display === "") ? "block" : "none"; // Toggle display
}

// Function to search posts
function searchPosts() {
  let input = document.getElementById('search-bar').value.toLowerCase();
  let posts = document.getElementsByClassName('post');

  for (let i = 0; i < posts.length; i++) {
    let fileName = posts[i].getElementsByClassName('file-name')[0].innerText.toLowerCase();
    posts[i].style.display = fileName.includes(input) ? "" : "none"; // Show or hide the post
  }
}

function checkEnter(event) {
  if (event.key === "Enter") {
    searchPosts();
  }
}

// Load links on page load
window.onload = async function() {
  await loadLinks(); // Load links from the server
};

</script>
</body>
</html>
